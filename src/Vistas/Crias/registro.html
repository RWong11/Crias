<html lang="es">
  <head>
    <meta charset="utf-8">
    <link rel="stylesheet" href="../Contenido/css/bootstrap.min.css">
    <link rel="stylesheet" href="../Contenido/css/font-awesome.min.css">
    <link rel="stylesheet" href="../Contenido/css/vista.css">
    <link rel="stylesheet" href="../Contenido/css/sweetalert2.min.css">
    <script src="../Contenido/js/jquery-3.4.1.slim.min.js"></script>
    <script src="../Contenido/js/popper.min.js"></script>
    <script src="../Contenido/js/bootstrap.min.js"></script>
    <script src="../Contenido/js/sweetalert2.min.js"></script>
  </head>
  <body>
  <div class = "main"><div class = "wrapper">
   <div class="col-sm-8 offset-sm-2 text-center">
       <h1 class="display-4">Crias Registro</h1><br>
           <form id="formCrias" class="form-inlin justify-content-center">
               <div class="form-group row">
                   <label for="inputPeso" class="col-sm-3 col-form-label">Peso: </label>
                   <div class="col-sm-9">
                   <input id="inputPeso" type="number" step="0.01" min="0.1" max="1000" class="form-control" placeholder="Peso (KG)" required>
                   </div>
               </div>
               <div class="form-group row">
                   <label for="inputGrasa" class="col-sm-3 col-form-label">Cantidad de Grasa: </label>
                   <div class="col-sm-9">
                   <input id="inputGrasa" type="number" step="0.01" min="0.1" max="100" class="form-control" placeholder="Grasa" required>
                   </div>
               </div>
               <div class="form-group row">
	               	<label for="inputColor" class="col-sm-3 col-form-label">Color del Musculo: </label>
	                <div class="col-sm-9">
	                 <select id="inputColor" class="form-control" required>
	                 	<option value="" selected disabled>Seleccione un Color</option>
	                 </select>
	                </div>
               </div>
               <div class="form-group row">
	               	<label for="inputCiudad" class="col-sm-3 col-form-label">Ciudad de Origen: </label>
	                <div class="col-sm-9">
	                 <select id="inputCiudad" class="form-control" required>
	                 	<option value="" selected disabled>Seleccione una Ciudad</option>
	                 </select>
	                </div>
               </div>
               <button id="botonRegistrar" type="submit" class="btn btn-primary">Registrar</button>
           </form>
       </div>
   </div></div>
  </body>
<script>
$(document).ready(function() {
	cargarLista(1, $("#inputColor"));
	cargarLista(2, $("#inputCiudad"));
	
	 $("#formCrias").submit(function(event) {
		 event.preventDefault();
		 registrarCria();
	});
});

function registrarCria() {
	var peso = parseFloat($("#inputPeso").val());
	var grasa = parseFloat($("#inputGrasa").val());
	var color = parseInt($("#inputColor").val());
	var ciudad = parseInt($("#inputCiudad").val());

	var resultado = JSON.parse(window.java.registrarCria(peso, grasa, color, ciudad));
	if(resultado[1] > 0) {
		Swal.fire({
		  type: 'success',	
		  title: 'Cria (#'+resultado[1]+') registrada correctamente!',
		  animation: false,
		  timer: 4000,
		  customClass: {
		    popup: 'animated bounceInDown'
		  },
		  onClose: () => {
			  if(resultado[0] == 2)
              	alertaSensor();
          	}
		});
		
		$("#formCrias")[0].reset();
	}
	else {
		Swal.fire({
		  type: 'error',	
		  title: 'Hubo un error en la base de datos!',
		  animation: false,
		  timer: 4000,
		  customClass: {
		    popup: 'animated tada'
		  }
		});
	}
}

function alertaSensor() {
	Swal.fire({
		  type: 'info',	
		  title: 'Aviso',
		  text: 'Esta cria ha sido clasificada como grasa cobertura 2, recuerde ponerle su sensor!',
		  animation: false,
		  customClass: {
		    popup: 'animated wobble'
		  }
		});
}

function cargarLista(num, select) {
	var elementos = JSON.parse(window.java.cargarLista(num));
	elementos.forEach(function(elemento, index) {
		select.append(new Option(elemento.text, elemento.value));
	});
}

</script>
</html>